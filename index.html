<script>
let entrega="Mostrador", pago="Efectivo";
let carrito={}, precios={}, total=0;

function idify(t){
  return t.replace(/\s+/g,'_').replace(/[^\w]/g,'');
}

const productos = [

/* ================= EMPANADAS ================= */
{
  cat:"ðŸ¥Ÿ Empanadas - $60 c/u",
  precio:60,
  items:[
    ["CARNE",""],
    ["Empanada Criolla","carne y huevo"],
    ["Empanada Mendocina","carne, huevo y aceituna"],
    ["Empanada Mexicana","carne, huevo, aceituna y pimienta"],
    ["Empanada Cordobesa","carne, huevo y pasas"],
    ["Empanada Mixta","carne, huevo, choclo y calabresa"],
    ["Empanada Gallega","carne, huevo y panceta"],
    ["Empanada Burguer","carne, cebolla y cheddar"],

    ["POLLO",""],
    ["Empanada Pollo clÃ¡sico","pollo, salsa y huevo"],
    ["Empanada Pollo queso","pollo, queso y aceituna"],
    ["Empanada Pollo requesÃ³n","pollo y requesÃ³n"],
    ["Empanada Pollo mostaza","pollo a la mostaza"],

    ["VERDURA",""],
    ["Empanada Palmito","jamÃ³n y salsa golf"],
    ["Empanada Acelga","cebolla, morrÃ³n y huevo"],
    ["Empanada Humita","choclo, queso y salsa blanca"],
    ["Empanada Choclo y jamÃ³n",""],
    ["Empanada Caprese","queso, tomate y albahaca"],

    ["MOZZARELLA",""],
    ["Empanada Pizza","mozzarella, salsa y orÃ©gano"],
    ["Empanada Alemana","mozzarella y frankfurter"],
    ["Empanada Napolitana","mozzarella, jamÃ³n, morrÃ³n y longaniza"],
    ["Empanada CaribeÃ±a","mozzarella, salame y aceituna"],
    ["Empanada Mozzarella y panceta",""],
    ["Empanada Mozzarella, cebolla y calabresa",""],

    ["QUESO",""],
    ["Empanada JamÃ³n y queso",""],
    ["Empanada Queso, calabresa y salsa",""],
    ["Empanada Queso y cebolla",""],
    ["Empanada Queso y aceituna",""],
    ["Empanada 4 Quesos","catupiri, roquefort, mozzarella y parmesano"],

    ["DULCES",""],
    ["Empanada Dulce de leche",""],
    ["Empanada Membrillo",""],
    ["Empanada Crema pastelera",""],
    ["Empanada Nutella",""]
  ]
},

/* ================= BEBIDAS ================= */
{
  cat:"ðŸ¥¤ Bebidas",
  items:[
    ["Coca-Cola Mini",40],
    ["Coca-Cola Lata",60],
    ["Coca-Cola 600 ml",80],
    ["Coca-Cola 2L",120],
    ["Fanta Mini",40],
    ["Fanta Lata",60],
    ["Sprite Mini",40],
    ["Sprite Lata",60]
  ]
},

/* ================= JUGOS ================= */
{
  cat:"ðŸ¹ Jugos Naturales",
  items:[
    ["Jugo de Mango",120],
    ["Jugo de Frutilla",120],
    ["Jugo de Naranja",120],
    ["Jugo de AnanÃ¡",120]
  ]
},

/* ================= CERVEZAS ================= */
{
  cat:"ðŸº Cervezas",
  items:[
    ["Pilsen Lata",120],
    ["Pilsen 2L",180],
    ["Patricia Lata",120],
    ["Patricia 2L",220],
    ["Glacial Lata",110]
  ]
}

];

function render(){
  let html="";
  productos.forEach(sec=>{
    html+=`<div class="card"><div class="section-title">${sec.cat}</div>`;
    sec.items.forEach(i=>{
      if(i[1]==="" && i[0]===i[0].toUpperCase()){
        html+=`<div class="sub-title">${i[0]}</div>`;
        return;
      }

      const nombre=i[0];
      const precio = sec.precio ? sec.precio : i[1];
      const desc   = sec.precio ? i[1] : "$"+i[1];
      const id=idify(nombre);

      carrito[id]=0;
      precios[id]=precio;

      html+=`
      <div class="item">
        <div>
          <div class="name">${nombre}</div>
          <div class="desc">${desc}</div>
        </div>
        <div class="controls">
          <button class="minus" onclick="chg('${id}',-1)">âˆ’</button>
          <span id="${id}">0</span>
          <button class="plus" onclick="chg('${id}',1)">+</button>
        </div>
      </div>`;
    });
    html+="</div>";
  });
  document.getElementById("menu").innerHTML=html;
}

function chg(id,d){
  carrito[id]=Math.max(0,carrito[id]+d);
  document.getElementById(id).innerText=carrito[id];
  calcular();
}

function calcular(){
  total=0;
  for(let k in carrito) total+=carrito[k]*precios[k];
  document.getElementById("total").innerText=total;
  resumen();
}

function resumen(){
  let r="";
  for(let k in carrito) if(carrito[k])
    r+=`${carrito[k]} ${k.replace(/_/g," ")}<br>`;
  document.getElementById("resumen").innerHTML =
    r || "<small>No hay productos seleccionados</small>";
}

render();
</script>
